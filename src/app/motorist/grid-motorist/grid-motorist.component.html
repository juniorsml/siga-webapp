<div class="material-content-container">
 
    <div [ngClass]="styleClass" class="columns level-left">
        <div class="column is-3">     
            <p class="control has-icons-left"> 
              <input [(ngModel)]="text" class="input"  placeholder="Buscar" type="text"/>
              <span class="icon is-small is-left">
                <i class="fa fa-search"></i>
              </span>       
            </p>
        </div>
        <div class="column is-4 level-left">     
            <p class="control has-icons-left"> 
             <input #input [(ngModel)]="placeText" (keyup)="onPlacesKeyUp()" type="text" class="input" placeholder="Endereço / Região">
              <span class="icon is-small is-left">
                <i class="fa fa-map-marker"></i>
              </span>       
            </p>
        </div>
        <div class="column is-2">        
            <p class="control has-icons-left"> 
                <input [(ngModel)]="distance" (keyup)="onDistanceKeyUp()" type="text" class="input" placeholder="Distância (KM)">
                <span class="icon is-small is-left">
                    <i class="fa fa-location-arrow"></i>
                </span>       
            </p>
        </div>
      </div>
      <!-- <sga-map-filter (placesFiltered)="onPlacesFiltered($event)" (filterRemoved)="onPlacesFilterRemoved($event)"  class="columns column"> 
      </sga-map-filter> -->

  <div class="container-grid">
    <data-table [data]="motorists | placesFilter: [filterLocation, filterDistance, 'location.latitude', 'location.longitude']"
      [dataLength]="motorists.length" [searchText]="text" [searchColumns]="['documentId', 'firstName', 'lastName', 'location.driverStatus', 'location.speed', 'location.altitude', 'location.mode']"
      [emptySearchText]="'nenhuma motorista foi encontrado'" [bodyBottom]="'42px'" [bodyTop]="'26px'" (onCellClick)="onCellClick($event)"
      (onCellRightClick)="onCellRightClick($event)">
      <table-empty>
        <ng-template>
          <!-- <div *ngIf="dataLoading" style="position: absolute; top: -40px; bottom: 0px; left: 0px; right: 0px">
            <rectangle-spinner></rectangle-spinner>
          </div> -->
          <div *ngIf="!dataLoading" style="position: absolute; top: 50%; left: 0px; right: 0px; margin-top: -20px;">
            <i class="glyphicons glyphicons-group" style="color: #e9eaed; width: 100%; text-align: center; font-size: 20px; margin-bottom: 12px;"></i>
            <span style="width: 100%; text-align: center; display: block; color: #a5abb3; font-size: 12px;">nenhuma motorista foi encontrado</span>
          </div>
        </ng-template>
      </table-empty>
      <column class="photo-profile" [key]="'id'" [header]="''" [minWidth]="'50'" >
        <ng-template let-item="item">
          <div class="cnt-img">
            <img (click)="showMotoristModal(item)" style="width: 40px; height: 40px; border-radius: 50%;" src="{{'api/motorist/public/profileImage?id=' + item}}"
              alt="">
          </div>
        </ng-template>
      </column>
      <column [key]="'documentId'" [header]="'Documento'" [minWidth]="'82'">
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'firstName'" [header]="'Nome'" [minWidth]="'43'">
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'lastName'" [header]="'Sobre Nome'" [minWidth]="'90'">
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'location'" [header]="'Status'" [minWidth]="'46'">
        <ng-template let-item="item">
          {{item != null ? (item.driverStatus) : '-'}}
        </ng-template>
      </column>
      <column [key]="'location'" [header]="'Velocidade'" [minWidth]="'80'">
        <ng-template let-item="item">
          {{item != null ? (item.speed | number:'1.1-1') : '- '}} km/h
        </ng-template>
      </column>
      <column [key]="'location'" [header]="'Altitude'" [minWidth]="'56'">
        <ng-template let-item="item">
          {{item != null ? (item.altitude | number:'1.1-1') : '- '}} m
        </ng-template>
      </column>
      <column [key]="'location'" [header]="'Bateria'" [minWidth]="'52'">
        <ng-template let-item="item">
          <span class="battery-level">
            <span class="battery-level-body">
              <span class="battery-level-charge" [style.background-color]="'hsl('+ (item?.battery?.charge * 100) +', 100%, 40%)'" [style.width]="(item?.battery?.charge * 100)+'%'">
              </span>
              <span class="battery-level-text">
                <span *ngIf="item?.battery?.chargeMode != null" class="fa fa-bolt" aria-hidden="true"></span>
                <span>{{ (item?.battery?.charge * 100) | number: '2.0-0'}}%</span>
              </span>
            </span>
          </span>
        </ng-template>
      </column>
      <column [key]="'location'" [header]="'Modo'" [minWidth]="'46'">
        <ng-template let-item="item">
          {{item != null ? (item?.mode) : '-'}}
        </ng-template>
      </column>
      <column [key]="'location'" [header]="'Atualizado'" [minWidth]="'82'">
        <ng-template let-item="item">
          {{item != null ? (item?.time | date:'medium') : '-'}}
        </ng-template>
      </column>
      <context-menu [mode]="'click'" [ignoreCells]="[0]" (onItemSelected)="contextMenuSelected($event)">
        <menu-item [enabled]="selectedMotorist?.location != null">
          <ng-template>
            <span class="table-menu-icon fal fa-location-arrow" aria-hidden="true">
            </span>
            <span>Localização</span>
          </ng-template>
        </menu-item>
        <menu-item [enabled]="selectedMotorist?.location != null">
          <ng-template>
            <span class="table-menu-icon fal fa-clock" aria-hidden="true">
            </span>
            <span>Histórico</span>
          </ng-template>
        </menu-item>
        <menu-item [enabled]="true">
          <ng-template>
            <span class="table-menu-icon fal fa-comments" aria-hidden="true">
            </span>
            <span>Mensagem</span>
          </ng-template>
        </menu-item>
        <menu-item [enabled]="true">
          <ng-template>
            <span class="table-menu-icon fal fa-film" aria-hidden="true">
            </span>
            <span>Vídeo</span>
          </ng-template>
        </menu-item>
      </context-menu>
    </data-table>
  </div>
</div>
<!-- <modal>
  <motorist-profile-dialog [showDialog]="showMotoristDialog" [selectedMotorist]="selectedMotorist" (onDialogClose)="motoristDialogClose()">
  </motorist-profile-dialog>
</modal> -->