<div>
  <sga-map-filter 
    (placesFiltered)="onPlacesFiltered($event)" 
    (filterRemoved)="onPlacesFilterRemoved()"
    class="column is-11">
  </sga-map-filter>

  <div class="container-grid container-grid-wrapper" [ngStyle]="{'top': showFilterBar ? '65px' : '0'}">
    <data-table 
      [data]="devices | placesFilter: [filterLocation, filterDistance, 'location.latitude', 'location.longitude']"
      [dataLength]="devices.length" 
      [searchText]="text" 
      [searchColumns]="['alias', 'model']"
      [emptySearchText]="'Nenhum dispositivo encontrado'" 
      [bodyBottom]="'42px'" 
      [bodyTop]="'26px'"
      (onCellClick)="onCellClick($event)"

      (onCellRightClick)="onCellRightClick($event)">
      <table-empty>
        <ng-template>
          <!-- <div *ngIf="dataLoading" style="position: absolute; top: -40px; bottom: 0px; left: 0px; right: 0px">
            <rectangle-spinner></rectangle-spinner>
          </div> -->
          <div *ngIf="!dataLoading" style="position: absolute; top: 50%; left: 0px; right: 0px; margin-top: -20px;">
            <i class="glyphicons glyphicons-group" style="color: #e9eaed; width: 100%; text-align: center; font-size: 20px; margin-bottom: 12px;"></i>
            <span style="width: 100%; text-align: center; display: block; color: #a5abb3; font-size: 12px; margin-top: 1em;">Nenhum dispositivo encontrado</span>
          </div>
        </ng-template>
      </table-empty>
      <column [key]="'id'" [header]="'ID'" [minWidth]="'82'" [isSortable]="false">
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'name'" [header]="'Nome'" [minWidth]="'43'" [isSortable]="true"> 
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'model'" [header]="'Modelo'" [minWidth]="'90'" [isSortable]="true">
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'tech'" [header]="'Tecnologia'" [minWidth]="'90'" [isSortable]="false">
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'updated'" [header]="'Atualizado'" [minWidth]="'43'" [isSortable]="false"> 
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'distance'" [header]="'Localização'" [minWidth]="'43'" [isSortable]="false"> 
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'speed'" [header]="'Velocidade'" [minWidth]="'43'" [isSortable]="false"> 
        <ng-template let-item="item">
          {{item}}
        </ng-template>
      </column>
      <column [key]="'battery'" [header]="'Bateria'" [minWidth]="'43'" [isSortable]="false"> 
        <ng-template let-item="item">
          <span class="battery-level">
            <span class="battery-level-body">
              <span class="battery-level-charge" [style.background-color]="'hsl('+ (item?.battery?.charge * 100) +', 100%, 40%)'" [style.width]="(item?.battery?.charge * 100)+'%'">
              </span>
              <span class="battery-level-text">
                <span *ngIf="item?.battery?.chargeMode !== null" class="fa fa-bolt" aria-hidden="true"></span>
                <span>{{ (item?.battery?.charge * 100) | number: '2.0-0'}}%</span>
              </span>
            </span>
          </span>
        </ng-template>
      </column>
    </data-table>
  </div>
</div>